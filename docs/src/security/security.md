# 加密解密知识大全

## 一、加解密基础知识
目前常用的加密方式就对称性加密和非对称性加密。

### 1、非对称加密和对称加密

#### 1）非对称加密

非对称加密算法是一种密钥的保密方法。 非对称加密算法需要两个密钥：公开密钥（publickey:简称公钥）和私有密钥（privatekey:简称私钥）。 
公钥与私钥是一对，如果用公钥对数据进行加密，只有用对应的私钥才能解密。

因为加密和解密使用的是两个不同的密钥，所以这种算法叫作非对称加密算法。

常用算法有DSA、RSA，**RSA 是主流的非对称加密算法** 。

RSA 需要先由服务端生成公钥和私钥，公钥下发给客户端，私钥存储在服务端。公钥用于加密，私钥用于解密。它的优点是：安全 ；它的缺点是：加密速度慢。

RSA的流程大致是如下这样：

```
客户端向服务器发送消息： 客户端用公钥加密信息，发送给服务端，服务端再用私钥解密
服务器向客户端发送消息：服务端用私钥加密信息，发送给客户端，客户端再用公钥解密
```

看到这里有些小伙伴肯定会和我一样提出质疑：公钥和私钥泄露了怎么办？ 要保障密钥的安全，有很多方式，比如数字证书，证书签名等等，这些在后续的学习中都会涉及到。



#### 2）对称加密

**使用相同的密钥进行加密和解密的过程就是对称加密。**

加密秘钥和解密秘钥是一样，当密钥被别人知道后，就相当于没有加密了。

常用的算法有DES、AES，**AES 是主流的对称加密算法**。

AES加密解密算法是一种可逆的对称加密算法，这类算法在加密和解密时使用相同的密钥，或是使用两个可以简单地相互推算的密钥，一般用于服务端对服务端之间对数据进行加密解密。它是一种为了替代原先DES、3DES而建立的高级加密标准（Advanced Encryption Standard）。作为可逆且对称的块加密，AES加密算法的速度比公钥加密等加密算法快很多，在很多场合都需要AES对称加密，但是要求加密端和解密端双方都使用相同的密钥是AES算法的主要缺点之一。它的优点：加密速度快；它的缺点：如果密钥丢失，就容易解密密文，安全性相对比较差。

虽然非对称加密更加安全，但是对称加密算法比非对称加密算法快大约1500倍。所有拥有更大的性能优势。**在实际过程中，一般是将对称加密和非对称加密相结合进行使用。** 比如将前面提到的RSA和AES结合使用。



#### 3）单向加密

单向加密指只能加密数据，而不能解密数据。常用的有MD5，SHA系列算法。

> 小结一下，上面三种加密理论分别都有多种不同的算法实现，他们主要的区别在于：
>
> 非对称加密：身份验证
>
> 对称加密：数据的机密性
>
> 单向加密：数据的完整性


 ### 2、加密解密策略

加密解密的操作最终都是为了提升数据安全性，安全性的差别在于使用什么加密解密方式，制定什么样的加密策略。


- 可进行加密的策略有：
  - AES
  - DES
  - RSA
  - BASE64
  - SM2
  - SM4
- 可进行解密的策略有：
  - AES
  - DES
  - RSA
  - BASE64
  - SM2
  - SM4


## 二、常见应用场景
- 接口出入参加解密

  小郭以常用的springboot应用程序接口来示例如何做数据加解密

  

- 文件上传加解密

  思路：获取原始文件的byte数组，然后加密生成新文件，然后上传新的文件。  服务端收到新文件后转成byte数组，然后解密，再重生成新的原始文件

  [java实现文件加解密方案 - 福尔摩狼 - 博客园 (cnblogs.com)](https://www.cnblogs.com/unruly/p/15992273.html)

  [java如何对要上传的文件进行加密和解密 - CSDN文库](https://wenku.csdn.net/answer/e4b81f8b2e0a4f219b348574669bd27d)

- 调用三方http接口传参加解密

- 跨语言调用加解密

  java调用python传参加解密[最新版-Python和Java实现Aes相互加解密-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/2285680)

  



## 三、数字证书

 对于非对称加密算法和数字签名来说，很重要的步骤就是公钥的分发。理论上任何人都可以获取到公开的公钥，然而这个公钥文件有可能是伪造的，传输过程中也有可能被篡改，所以一旦公钥自身出了问题，则整个建立在其上的的安全性将不复成立。

**数字证书机制** 用于解决公钥分发安全性问题，确保所记录信息的合法性。比如证明某个公钥是某个实体（个人或组织）拥有，并且确保任何篡改都能被检测出来，从而实现对用户公钥的安全分发。

服务器拥有公开密钥，它把公钥交给认证机构，机构给他的公钥上打上数字签名并发一个证书，表示这个公钥是正规的。当服务器把公钥给客户端之后，客户端还要通过签名验证公钥的真实性。

根据所保护公钥的用途，数字证书可以分为 **加密数字证书（Encryption Certificate）** 和 **签名验证数字证书（Signature Certificate）**。

- **加密数字证书** 用来保护加密用途的公钥
- **签名验证数字证书** 用来保护签名用途的公钥

上面这两种类型的公钥可以同时放在同一证书中存储。

一般情况下，证书需要由 **证书认证机构（Certification Authority，CA）** 来进行签发和背书。

- 权威的商业证书认证机构包括 DigiCert、GlobalSign、VeriSign 等
- 用户也可以自行搭建本地 CA 系统，在私有网络中进行自有证书的签发和背书

一个数字证书内容可能包括证书域（证书的版本、序列号、签名算法类型、签发者信息、有效期、被签发主体、签发的公开密钥）、CA 对证书的签名算法和签名值等，他们一般采用 `X.509` 规范编写。那么`X.509`规范又是什么呢？

**X.509 证书规范**

X.509 是密码学里公钥证书的格式标准。

证书格式有如下几种分类：

- 证书文件的文件名后缀一般为 `.crt` 或 `.cer`
- 对应私钥文件的文件名后缀一般为 `.key`
- 证书请求文件的文件名后缀为 `.csr`
- 有时候也统一用 `.pem` 作为文件名后缀

`X.509` 规范中一般推荐使用 PEM（Privacy Enhanced Mail）格式来存储证书相关的文件。

**PEM 格式** 采用文本方式进行存储，一般包括首尾标记和内容块，内容块采用 Base64 格式编码，示例如下：

```
-----BEGIN CERTIFICATE-----
BASE64 CONTENT
-----END CERTIFICATE-----
```

按照 `X.509` 规范，公钥可以通过证书机制来进行保护，但证书的生成、分发、撤销等步骤并未涉及，接下来要讲的PKI体系中定义了这些步骤需要遵循标准。

## 四、PKI 体系

**PKI（Public Key Infrastructure）体系** 解决了证书生命周期相关的认证和管理问题，定义了安全地管理、分发证书需要遵循的标准。

PKI 是建立在公私钥基础上实现安全可靠传递消息和身份确认的一个通用框架，并不代表某个特定的密码学技术和流程，实现了 PKI 规范的平台可以安全可靠地管理网络中用户的密钥和证书。

一个完备 PKI 体系应该包括如下组件：

- **数字证书**：包含了用于签名和加密数据的公钥的电子凭证，是 PKI 的核心元素
- **认证中心（CA）**：数字证书的申请及签发机关，CA 必须具备权威性
- **证书资料库**：存储已签发的数字证书和公钥，以及相关证书目录，用户可由此获得所需的其他用户的证书及公钥
- **证书吊销列表（CRL）/OCSP**：在有效期内吊销的证书列表，OCSP（在线证书状态协议）是获得证书状态的国际协议
- **密钥备份及恢复**：为避免因用户丢失解密密钥而无法解密合法数据的情况，PKI 应提供备份与恢复密钥的机制
- **PKI 应用接口（API）**：为应用提供安全、一致、 可信的方式与 PKI 交互





## 五、工具

[AES在线加密解密工具 - MKLab在线工具](https://www.mklab.cn/utils/aes)





## 六、参考链接

[python，java跨语言RSA+AES混合加密解密以及踩过的那些坑 - 简书 (jianshu.com)](https://www.jianshu.com/p/43fe5da02f1a)

[SpringBoot-实现RAS+AES自动接口解密 - 掘金 (juejin.cn)](https://juejin.cn/post/7203931072260915259?searchId=20231121092208457D455795B50B66380E)

[密码学基础（二）数字证书、密钥基础知识 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/378068050)

[一个注解搞定SpringBoot接口定制属性加解密 - 掘金 (juejin.cn)](https://juejin.cn/post/7130890175139774472)

[Spring Boot 接口加解密，新姿势来了！_springboot 加解密-CSDN博客](https://blog.csdn.net/m88997766/article/details/130145587)

